# 🧩 项目进度影响分析报告（基于需求文档 v1.1）

## 1. 概述
本文档用于评估《课程评分系统需求文档（v1.1）》对现有项目进度与 Issue 列表的影响，确保项目在需求调整后仍能平稳推进。  
评估范围基于上次会话备份文件（2025-11-02）。

---

## 2. 现有 Issue 列表回顾

| Issue ID | 标题 | 状态 | 说明 |
|-----------|-------|-------|------|
| #1 | 初始化 Next.js 项目 | ✅ 已完成 (`feature/1-init-next`) |
| #3 | 初始化 Prisma 与迁移 | ⏳ 待进行 |
| #4 | 公共库（prisma.ts、auth.ts） | 待开发 |
| #5 | 环境变量模板 | 待开发 |
| #6 | README 快速开始 | 待开发 |

---

## 3. 需求变更摘要

新版《v1.1 需求文档》主要更新内容：

1. 教师不登录系统（单向评分：学生→教师）  
2. 增加教师综合评分展示（平均分 + 评价人数）  
3. 增加校园网 IP 访问限制  
4. 明确学生是唯一登录用户  
5. 标准化评分维度（教学态度、内容清晰度、互动等）  

---

## 4. 对现有 Issue 的影响分析

| Issue | 影响分析 | 建议处理 |
|-------|------------|----------|
| **#1 Init Next.js** | ✅ 无影响。初始化逻辑、环境配置不变。 | 保持已完成。 |
| **#3 Prisma 初始化与迁移** | ⚠️ 模型需更新：原设计包含 `User` 与 `Role`，现改为仅 `Student`。 | 使用新版 `schema.prisma`，迁移名：`simplify-models`。 |
| **#4 公共库** | ✅ 基本不受影响。JWT 验证仅针对学生，逻辑更简。 | 保留现有计划。 |
| **#5 环境变量模板** | ✅ 无影响，仅新增 `ALLOWED_IP_PREFIXES`。 | 更新 `.env.example`。 |
| **#6 README 快速开始** | ⚠️ 内容需调整，补充校内访问限制说明与新数据库模型。 | 在更新文档时同步修改。 |

---

## 5. 新增 Issue 建议

| Issue ID | 标题 | 描述 |
|-----------|------|------|
| **#7 教师综合评分接口** | 实现 `/api/teacher/[id]/rating`，聚合所有课程评分，返回平均分与评价数。 |
| **#8 校园网访问限制中间件** | 在 `middleware.ts` 中添加 IP 白名单校验，读取 `.env` 中的 `ALLOWED_IP_PREFIXES`。 |

---

## 6. 建议执行顺序

1. 更新并迁移数据库（`npx prisma migrate dev --name simplify-models`）  
2. 完成 JWT 注册与登录逻辑（学生端）  
3. 实现教师评分与综合评分接口  
4. 添加校园网访问限制中间件  
5. 更新 README、`.env.example` 与文档  

---

## 7. 结论

| 类型 | 影响程度 | 行动 |
|------|------------|------|
| 已完成任务（#1） | 无影响 | 无需修改 |
| 进行中任务（#3, #4, #5, #6） | 轻微调整 | 仅需更新数据库模型与变量 |
| 新增需求 | 新增 2 个 Issue | 并行开发即可 |

**总体结论：**  
> ✅ 本次需求更新与现有开发进度兼容。  
> 无需重构，仅需轻度调整数据库与文档，即可继续向 A2 阶段推进。

---

## 8. 文件信息
- 文档版本：v1.0  
- 生成时间：2025-11-03  
- 基于需求文档：`课程评分系统_需求文档_v1.1.md`  
- 适用仓库：`fsssb/course-rate`
